<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>cURL Builder - DevChef Tool</title>
</head>
<body>

<!-- DevChef Manifest -->
<script type="devchef-manifest">
{
  "id": "curl-builder",
  "name": "cURL Builder",
  "category": "Development",
  "description": "Build and test HTTP requests with cURL command generator for APIs, webhooks, and HTTP endpoints",
  "version": "1.0.0"
}
</script>

<!-- Tool UI Template -->
<template id="tool-ui">
  <div class="tool-container">
    <div class="tool-header">
      <h2 class="tool-title">cURL Builder</h2>
      <p class="tool-description">Build, test, and generate cURL commands for REST APIs, webhooks, and HTTP requests</p>
    </div>

    <div class="main-layout">
      <div class="scenarios-panel">
        <div class="panel-header">
          <h3>üì¶ Quick Scenarios</h3>
        </div>

        <div class="scenario-categories">
          <div class="category">
            <h4>üî∑ REST API</h4>
            <button class="scenario-btn" data-scenario="rest-get">GET Request</button>
            <button class="scenario-btn" data-scenario="rest-post-json">POST JSON</button>
            <button class="scenario-btn" data-scenario="rest-put">PUT Update</button>
            <button class="scenario-btn" data-scenario="rest-delete">DELETE</button>
            <button class="scenario-btn" data-scenario="rest-patch">PATCH</button>
          </div>

          <div class="category">
            <h4>üîê Authentication</h4>
            <button class="scenario-btn" data-scenario="auth-basic">Basic Auth</button>
            <button class="scenario-btn" data-scenario="auth-bearer">Bearer Token</button>
            <button class="scenario-btn" data-scenario="auth-api-key">API Key</button>
            <button class="scenario-btn" data-scenario="auth-oauth">OAuth 2.0</button>
          </div>

          <div class="category">
            <h4>üì§ File Upload</h4>
            <button class="scenario-btn" data-scenario="upload-single">Single File</button>
            <button class="scenario-btn" data-scenario="upload-multiple">Multiple Files</button>
            <button class="scenario-btn" data-scenario="upload-form-data">Form Data</button>
          </div>

          <div class="category">
            <h4>üîî Webhooks</h4>
            <button class="scenario-btn" data-scenario="webhook-github">GitHub Webhook</button>
            <button class="scenario-btn" data-scenario="webhook-slack">Slack Webhook</button>
            <button class="scenario-btn" data-scenario="webhook-discord">Discord Webhook</button>
          </div>

          <div class="category">
            <h4>üß™ Testing</h4>
            <button class="scenario-btn" data-scenario="test-headers">Custom Headers</button>
            <button class="scenario-btn" data-scenario="test-timeout">With Timeout</button>
            <button class="scenario-btn" data-scenario="test-redirect">Follow Redirects</button>
            <button class="scenario-btn" data-scenario="test-download">Download File</button>
          </div>
        </div>
      </div>

      <div class="builder-panel">
        <div class="request-builder">
          <div class="method-url-row">
            <select id="http-method" class="method-select">
              <option value="GET">GET</option>
              <option value="POST">POST</option>
              <option value="PUT">PUT</option>
              <option value="PATCH">PATCH</option>
              <option value="DELETE">DELETE</option>
              <option value="HEAD">HEAD</option>
              <option value="OPTIONS">OPTIONS</option>
            </select>
            <input type="text" id="url-input" class="url-input" placeholder="https://api.example.com/v1/users">
          </div>

          <div class="tabs">
            <button class="tab-btn active" data-tab="headers">Headers</button>
            <button class="tab-btn" data-tab="auth">Auth</button>
            <button class="tab-btn" data-tab="body">Body</button>
            <button class="tab-btn" data-tab="options">Options</button>
          </div>

          <div id="headers-tab" class="tab-content active">
            <div class="section-header">
              <h4>Request Headers</h4>
              <button id="add-header-btn" class="add-btn">+ Add Header</button>
            </div>
            <div id="headers-list" class="key-value-list">
              <div class="key-value-row">
                <input type="text" placeholder="Header name" value="Content-Type" class="header-key">
                <input type="text" placeholder="Header value" value="application/json" class="header-value">
                <button class="remove-btn">‚úï</button>
              </div>
            </div>
          </div>

          <div id="auth-tab" class="tab-content">
            <div class="section-header">
              <h4>Authentication</h4>
              <select id="auth-type" class="auth-select">
                <option value="none">No Auth</option>
                <option value="basic">Basic Auth</option>
                <option value="bearer">Bearer Token</option>
                <option value="api-key">API Key</option>
              </select>
            </div>
            <div id="auth-config" class="auth-config">
              <p class="hint">Select an authentication type</p>
            </div>
          </div>

          <div id="body-tab" class="tab-content">
            <div class="section-header">
              <h4>Request Body</h4>
              <select id="body-type" class="body-select">
                <option value="none">No Body</option>
                <option value="json">JSON</option>
                <option value="form-data">Form Data</option>
                <option value="x-www-form-urlencoded">URL Encoded</option>
                <option value="raw">Raw</option>
              </select>
            </div>
            <div id="body-content" class="body-content">
              <textarea id="body-data" placeholder='{\n  "key": "value"\n}'></textarea>
            </div>
          </div>

          <div id="options-tab" class="tab-content">
            <div class="section-header">
              <h4>cURL Options</h4>
            </div>
            <div class="options-grid">
              <label class="option-label">
                <input type="checkbox" id="opt-verbose">
                Verbose output (-v)
              </label>
              <label class="option-label">
                <input type="checkbox" id="opt-follow-redirects">
                Follow redirects (-L)
              </label>
              <label class="option-label">
                <input type="checkbox" id="opt-insecure">
                Insecure/Skip SSL (-k)
              </label>
              <label class="option-label">
                <input type="checkbox" id="opt-include-headers">
                Include headers in output (-i)
              </label>
              <label class="option-label">
                <input type="checkbox" id="opt-compressed">
                Request compression (--compressed)
              </label>
              <label class="option-label">
                <input type="checkbox" id="opt-show-error">
                Show errors (-S)
              </label>
            </div>
            <div class="option-row">
              <label>Timeout (seconds):</label>
              <input type="number" id="opt-timeout" placeholder="30" min="1">
            </div>
            <div class="option-row">
              <label>Max redirects:</label>
              <input type="number" id="opt-max-redirects" placeholder="10" min="0">
            </div>
            <div class="option-row">
              <label>User Agent:</label>
              <input type="text" id="opt-user-agent" placeholder="curl/7.68.0">
            </div>
          </div>
        </div>

        <div class="output-section">
          <div class="output-header">
            <h4>Generated cURL Command</h4>
            <div class="output-actions">
              <button id="copy-curl-btn" class="action-btn">üìã Copy</button>
              <button id="export-curl-btn" class="action-btn">üíæ Export</button>
            </div>
          </div>
          <div id="curl-output" class="curl-output"></div>
        </div>
      </div>
    </div>

    <div class="examples-section">
      <label class="section-label">üí° Tips & Examples</label>
      <div class="tips-grid">
        <div class="tip-card">
          <strong>üîπ POST JSON Data</strong>
          <code>curl -X POST -H "Content-Type: application/json" -d '{"key":"value"}' URL</code>
        </div>
        <div class="tip-card">
          <strong>üîπ Basic Authentication</strong>
          <code>curl -u username:password URL</code>
        </div>
        <div class="tip-card">
          <strong>üîπ Bearer Token</strong>
          <code>curl -H "Authorization: Bearer TOKEN" URL</code>
        </div>
        <div class="tip-card">
          <strong>üîπ Download File</strong>
          <code>curl -o filename.ext URL</code>
        </div>
      </div>
    </div>
  </div>
</template>

<!-- Tool Styles -->
<style>
  .main-layout {
    display: grid;
    grid-template-columns: 280px 1fr;
    gap: 16px;
    margin-bottom: 24px;
  }

  .scenarios-panel,
  .builder-panel {
    background: var(--bg-secondary);
    border-radius: 12px;
    padding: 16px;
  }

  .scenarios-panel {
    max-height: 800px;
    overflow-y: auto;
  }

  .panel-header {
    margin-bottom: 16px;
  }

  .panel-header h3 {
    font-size: 16px;
    font-weight: 600;
    color: var(--text-primary);
    margin: 0;
  }

  .scenario-categories {
    display: flex;
    flex-direction: column;
    gap: 16px;
  }

  .category h4 {
    font-size: 12px;
    font-weight: 600;
    color: var(--text-secondary);
    margin-bottom: 8px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .scenario-btn {
    display: block;
    width: 100%;
    padding: 10px 12px;
    margin-bottom: 6px;
    background: var(--bg-primary);
    border: 1px solid var(--border-color);
    border-radius: 6px;
    color: var(--text-primary);
    font-size: 13px;
    text-align: left;
    cursor: pointer;
    transition: all 0.2s;
  }

  .scenario-btn:hover {
    border-color: var(--accent);
    background: var(--bg-tertiary);
    transform: translateX(4px);
  }

  .method-url-row {
    display: grid;
    grid-template-columns: 120px 1fr;
    gap: 12px;
    margin-bottom: 16px;
  }

  .method-select {
    padding: 12px;
    background: var(--bg-primary);
    border: 2px solid var(--border-color);
    border-radius: 8px;
    color: var(--text-primary);
    font-size: 14px;
    font-weight: 600;
  }

  .url-input {
    padding: 12px;
    background: var(--bg-primary);
    border: 2px solid var(--border-color);
    border-radius: 8px;
    color: var(--text-primary);
    font-family: var(--font-mono);
    font-size: 14px;
  }

  .url-input:focus {
    outline: none;
    border-color: var(--accent);
  }

  .tabs {
    display: flex;
    gap: 4px;
    margin-bottom: 16px;
    border-bottom: 2px solid var(--border-color);
  }

  .tab-btn {
    padding: 10px 16px;
    background: transparent;
    border: none;
    border-bottom: 2px solid transparent;
    color: var(--text-secondary);
    font-size: 13px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
    margin-bottom: -2px;
  }

  .tab-btn:hover {
    color: var(--text-primary);
  }

  .tab-btn.active {
    color: var(--accent);
    border-bottom-color: var(--accent);
  }

  .tab-content {
    display: none;
  }

  .tab-content.active {
    display: block;
  }

  .section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 12px;
  }

  .section-header h4 {
    font-size: 14px;
    font-weight: 600;
    color: var(--text-primary);
    margin: 0;
  }

  .add-btn {
    padding: 6px 12px;
    background: var(--accent);
    color: white;
    border: none;
    border-radius: 6px;
    font-size: 12px;
    font-weight: 600;
    cursor: pointer;
  }

  .key-value-list {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .key-value-row {
    display: grid;
    grid-template-columns: 1fr 2fr 40px;
    gap: 8px;
  }

  .key-value-row input {
    padding: 8px;
    background: var(--bg-primary);
    border: 1px solid var(--border-color);
    border-radius: 4px;
    font-size: 13px;
    color: var(--text-primary);
  }

  .remove-btn {
    padding: 8px;
    background: var(--bg-tertiary);
    border: 1px solid var(--border-color);
    border-radius: 4px;
    color: var(--text-secondary);
    cursor: pointer;
    transition: all 0.2s;
  }

  .remove-btn:hover {
    background: var(--error);
    color: white;
    border-color: var(--error);
  }

  .auth-select,
  .body-select {
    width: 100%;
    padding: 8px;
    background: var(--bg-primary);
    border: 1px solid var(--border-color);
    border-radius: 6px;
    font-size: 13px;
  }

  .auth-config {
    margin-top: 12px;
  }

  .auth-config .hint {
    color: var(--text-secondary);
    font-size: 13px;
    font-style: italic;
  }

  .auth-input {
    width: 100%;
    padding: 8px;
    margin-bottom: 8px;
    background: var(--bg-primary);
    border: 1px solid var(--border-color);
    border-radius: 4px;
    font-size: 13px;
  }

  .body-content {
    margin-top: 12px;
  }

  #body-data {
    width: 100%;
    min-height: 200px;
    padding: 12px;
    background: var(--bg-primary);
    border: 1px solid var(--border-color);
    border-radius: 6px;
    font-family: var(--font-mono);
    font-size: 13px;
    color: var(--text-primary);
    resize: vertical;
  }

  .options-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 12px;
    margin-bottom: 16px;
  }

  .option-label {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 13px;
    color: var(--text-primary);
    cursor: pointer;
  }

  .option-row {
    margin-bottom: 12px;
  }

  .option-row label {
    display: block;
    font-size: 13px;
    font-weight: 600;
    color: var(--text-secondary);
    margin-bottom: 6px;
  }

  .option-row input {
    width: 100%;
    padding: 8px;
    background: var(--bg-primary);
    border: 1px solid var(--border-color);
    border-radius: 4px;
    font-size: 13px;
  }

  .output-section {
    margin-top: 24px;
    padding-top: 24px;
    border-top: 2px solid var(--border-color);
  }

  .output-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 12px;
  }

  .output-header h4 {
    font-size: 14px;
    font-weight: 600;
    color: var(--text-primary);
    margin: 0;
  }

  .output-actions {
    display: flex;
    gap: 8px;
  }

  .action-btn {
    padding: 8px 16px;
    background: var(--accent);
    color: white;
    border: none;
    border-radius: 6px;
    font-size: 12px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
  }

  .action-btn:hover {
    opacity: 0.9;
  }

  .curl-output {
    padding: 16px;
    background: var(--bg-primary);
    border: 2px solid var(--border-color);
    border-radius: 8px;
    font-family: var(--font-mono);
    font-size: 13px;
    line-height: 1.8;
    color: var(--text-primary);
    white-space: pre-wrap;
    word-break: break-all;
    min-height: 100px;
  }

  .examples-section {
    padding-top: 24px;
    border-top: 2px solid var(--border-color);
  }

  .section-label {
    display: block;
    font-size: 13px;
    font-weight: 600;
    color: var(--text-secondary);
    margin-bottom: 12px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .tips-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 12px;
  }

  .tip-card {
    padding: 12px;
    background: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 8px;
  }

  .tip-card strong {
    display: block;
    margin-bottom: 8px;
    color: var(--text-primary);
    font-size: 13px;
  }

  .tip-card code {
    display: block;
    padding: 8px;
    background: var(--bg-primary);
    border-radius: 4px;
    font-family: var(--font-mono);
    font-size: 11px;
    color: var(--accent);
    word-break: break-all;
  }

  @media (max-width: 1200px) {
    .main-layout {
      grid-template-columns: 1fr;
    }

    .scenarios-panel {
      max-height: 400px;
    }
  }
</style>

<!-- Standalone Styles -->
<style id="standalone-styles">
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  :root {
    --bg-primary: #ffffff;
    --bg-secondary: #f5f5f5;
    --bg-tertiary: #e0e0e0;
    --border-color: #d0d0d0;
    --text-primary: #2c3e50;
    --text-secondary: #7f8c8d;
    --accent: #27ae60;
    --accent-hover: #229954;
    --error: #e74c3c;
    --font-mono: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', monospace;
    --font-sans: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  }

  body {
    font-family: var(--font-sans);
    background: var(--bg-primary);
    color: var(--text-primary);
    padding: 24px;
    line-height: 1.6;
  }

  .tool-container {
    max-width: 1800px;
    margin: 0 auto;
  }

  .tool-header {
    margin-bottom: 32px;
    padding-bottom: 16px;
    border-bottom: 2px solid var(--border-color);
  }

  .tool-title {
    font-size: 36px;
    font-weight: 700;
    background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin-bottom: 8px;
  }

  .tool-description {
    font-size: 16px;
    color: var(--text-secondary);
  }

  button {
    font-family: var(--font-sans);
  }
</style>

<!-- Tool Module Logic -->
<script type="module">
export const DevChefTool = {
  container: null,
  context: null,
  headers: [{ key: 'Content-Type', value: 'application/json' }],

  scenarios: {
    'rest-get': {
      method: 'GET',
      url: 'https://api.example.com/v1/users',
      headers: [{ key: 'Accept', value: 'application/json' }]
    },
    'rest-post-json': {
      method: 'POST',
      url: 'https://api.example.com/v1/users',
      headers: [{ key: 'Content-Type', value: 'application/json' }],
      body: JSON.stringify({ name: 'John Doe', email: 'john@example.com' }, null, 2),
      bodyType: 'json'
    },
    'rest-put': {
      method: 'PUT',
      url: 'https://api.example.com/v1/users/123',
      headers: [{ key: 'Content-Type', value: 'application/json' }],
      body: JSON.stringify({ name: 'Jane Doe', email: 'jane@example.com' }, null, 2),
      bodyType: 'json'
    },
    'rest-delete': {
      method: 'DELETE',
      url: 'https://api.example.com/v1/users/123',
      headers: [{ key: 'Accept', value: 'application/json' }]
    },
    'rest-patch': {
      method: 'PATCH',
      url: 'https://api.example.com/v1/users/123',
      headers: [{ key: 'Content-Type', value: 'application/json' }],
      body: JSON.stringify({ email: 'newemail@example.com' }, null, 2),
      bodyType: 'json'
    },
    'auth-basic': {
      method: 'GET',
      url: 'https://api.example.com/v1/protected',
      auth: { type: 'basic', username: 'user', password: 'pass' }
    },
    'auth-bearer': {
      method: 'GET',
      url: 'https://api.example.com/v1/protected',
      headers: [{ key: 'Authorization', value: 'Bearer YOUR_TOKEN_HERE' }]
    },
    'auth-api-key': {
      method: 'GET',
      url: 'https://api.example.com/v1/data',
      headers: [{ key: 'X-API-Key', value: 'your-api-key-here' }]
    },
    'upload-single': {
      method: 'POST',
      url: 'https://api.example.com/v1/upload',
      headers: [{ key: 'Content-Type', value: 'multipart/form-data' }],
      body: '--form file=@/path/to/file.pdf',
      bodyType: 'raw'
    },
    'webhook-slack': {
      method: 'POST',
      url: 'https://hooks.slack.com/services/YOUR/WEBHOOK/URL',
      headers: [{ key: 'Content-Type', value: 'application/json' }],
      body: JSON.stringify({
        text: 'Hello from cURL!',
        username: 'Bot',
        icon_emoji: ':robot_face:'
      }, null, 2),
      bodyType: 'json'
    },
    'webhook-discord': {
      method: 'POST',
      url: 'https://discord.com/api/webhooks/YOUR_WEBHOOK_ID/YOUR_WEBHOOK_TOKEN',
      headers: [{ key: 'Content-Type', value: 'application/json' }],
      body: JSON.stringify({
        content: 'Hello from cURL!',
        username: 'Bot'
      }, null, 2),
      bodyType: 'json'
    }
  },

  init(container, context) {
    this.container = container;
    this.context = context;

    // Scenario buttons
    container.querySelectorAll('.scenario-btn').forEach(btn => {
      btn.addEventListener('click', (e) => {
        const scenarioId = e.target.dataset.scenario;
        this.loadScenario(scenarioId);
      });
    });

    // Tabs
    container.querySelectorAll('.tab-btn').forEach(btn => {
      btn.addEventListener('click', (e) => {
        this.switchTab(e.target.dataset.tab);
      });
    });

    // Header management
    container.querySelector('#add-header-btn')?.addEventListener('click', () => this.addHeader());

    // Auth type change
    container.querySelector('#auth-type')?.addEventListener('change', (e) => {
      this.updateAuthConfig(e.target.value);
    });

    // Input changes
    container.querySelector('#http-method')?.addEventListener('change', () => this.generateCurl());
    container.querySelector('#url-input')?.addEventListener('input', () => this.generateCurl());
    container.querySelector('#body-type')?.addEventListener('change', () => this.generateCurl());
    container.querySelector('#body-data')?.addEventListener('input', () => this.generateCurl());

    // Options
    container.querySelectorAll('#options-tab input').forEach(input => {
      input.addEventListener('change', () => this.generateCurl());
    });

    // Actions
    container.querySelector('#copy-curl-btn')?.addEventListener('click', () => this.copyCurl());
    container.querySelector('#export-curl-btn')?.addEventListener('click', () => this.exportCurl());

    // Load default scenario
    this.loadScenario('rest-get');
  },

  switchTab(tabName) {
    this.container.querySelectorAll('.tab-btn').forEach(btn => {
      btn.classList.toggle('active', btn.dataset.tab === tabName);
    });
    this.container.querySelectorAll('.tab-content').forEach(content => {
      content.classList.toggle('active', content.id === `${tabName}-tab`);
    });
  },

  loadScenario(scenarioId) {
    const scenario = this.scenarios[scenarioId];
    if (!scenario) return;

    const methodSelect = this.container.querySelector('#http-method');
    const urlInput = this.container.querySelector('#url-input');
    const bodyData = this.container.querySelector('#body-data');
    const bodyType = this.container.querySelector('#body-type');

    methodSelect.value = scenario.method || 'GET';
    urlInput.value = scenario.url || '';

    if (scenario.headers) {
      this.headers = scenario.headers;
      this.renderHeaders();
    }

    if (scenario.body) {
      bodyData.value = scenario.body;
      bodyType.value = scenario.bodyType || 'json';
    }

    if (scenario.auth) {
      const authType = this.container.querySelector('#auth-type');
      authType.value = scenario.auth.type;
      this.updateAuthConfig(scenario.auth.type);
    }

    this.generateCurl();
  },

  addHeader() {
    this.headers.push({ key: '', value: '' });
    this.renderHeaders();
  },

  removeHeader(index) {
    this.headers.splice(index, 1);
    this.renderHeaders();
  },

  renderHeaders() {
    const headersList = this.container.querySelector('#headers-list');
    headersList.innerHTML = this.headers.map((header, index) => `
      <div class="key-value-row">
        <input type="text" placeholder="Header name" value="${header.key}" class="header-key" data-index="${index}">
        <input type="text" placeholder="Header value" value="${header.value}" class="header-value" data-index="${index}">
        <button class="remove-btn" data-index="${index}">‚úï</button>
      </div>
    `).join('');

    // Add event listeners
    headersList.querySelectorAll('.header-key').forEach(input => {
      input.addEventListener('input', (e) => {
        this.headers[e.target.dataset.index].key = e.target.value;
        this.generateCurl();
      });
    });

    headersList.querySelectorAll('.header-value').forEach(input => {
      input.addEventListener('input', (e) => {
        this.headers[e.target.dataset.index].value = e.target.value;
        this.generateCurl();
      });
    });

    headersList.querySelectorAll('.remove-btn').forEach(btn => {
      btn.addEventListener('click', (e) => {
        this.removeHeader(parseInt(e.target.dataset.index));
      });
    });
  },

  updateAuthConfig(authType) {
    const authConfig = this.container.querySelector('#auth-config');

    if (authType === 'basic') {
      authConfig.innerHTML = `
        <input type="text" id="auth-username" class="auth-input" placeholder="Username">
        <input type="password" id="auth-password" class="auth-input" placeholder="Password">
      `;
      authConfig.querySelectorAll('input').forEach(input => {
        input.addEventListener('input', () => this.generateCurl());
      });
    } else if (authType === 'bearer') {
      authConfig.innerHTML = `
        <input type="text" id="auth-token" class="auth-input" placeholder="Bearer Token">
      `;
      authConfig.querySelector('input').addEventListener('input', () => this.generateCurl());
    } else if (authType === 'api-key') {
      authConfig.innerHTML = `
        <input type="text" id="auth-key-name" class="auth-input" placeholder="Header Name (e.g., X-API-Key)">
        <input type="text" id="auth-key-value" class="auth-input" placeholder="API Key Value">
      `;
      authConfig.querySelectorAll('input').forEach(input => {
        input.addEventListener('input', () => this.generateCurl());
      });
    } else {
      authConfig.innerHTML = '<p class="hint">No authentication configured</p>';
    }
  },

  generateCurl() {
    const method = this.container.querySelector('#http-method').value;
    const url = this.container.querySelector('#url-input').value;
    const bodyType = this.container.querySelector('#body-type').value;
    const bodyData = this.container.querySelector('#body-data').value;
    const authType = this.container.querySelector('#auth-type').value;

    let curl = 'curl';

    // Method
    if (method !== 'GET') {
      curl += ` -X ${method}`;
    }

    // Headers
    this.headers.forEach(header => {
      if (header.key && header.value) {
        curl += ` \\\n  -H "${header.key}: ${header.value}"`;
      }
    });

    // Authentication
    if (authType === 'basic') {
      const username = this.container.querySelector('#auth-username')?.value || '';
      const password = this.container.querySelector('#auth-password')?.value || '';
      if (username) {
        curl += ` \\\n  -u "${username}:${password}"`;
      }
    } else if (authType === 'bearer') {
      const token = this.container.querySelector('#auth-token')?.value || '';
      if (token) {
        curl += ` \\\n  -H "Authorization: Bearer ${token}"`;
      }
    } else if (authType === 'api-key') {
      const keyName = this.container.querySelector('#auth-key-name')?.value || '';
      const keyValue = this.container.querySelector('#auth-key-value')?.value || '';
      if (keyName && keyValue) {
        curl += ` \\\n  -H "${keyName}: ${keyValue}"`;
      }
    }

    // Body
    if (bodyType !== 'none' && bodyData) {
      const escaped = bodyData.replace(/'/g, "'\\''");
      curl += ` \\\n  -d '${escaped}'`;
    }

    // Options
    if (this.container.querySelector('#opt-verbose')?.checked) {
      curl += ' \\\n  -v';
    }
    if (this.container.querySelector('#opt-follow-redirects')?.checked) {
      curl += ' \\\n  -L';
    }
    if (this.container.querySelector('#opt-insecure')?.checked) {
      curl += ' \\\n  -k';
    }
    if (this.container.querySelector('#opt-include-headers')?.checked) {
      curl += ' \\\n  -i';
    }
    if (this.container.querySelector('#opt-compressed')?.checked) {
      curl += ' \\\n  --compressed';
    }
    if (this.container.querySelector('#opt-show-error')?.checked) {
      curl += ' \\\n  -S';
    }

    const timeout = this.container.querySelector('#opt-timeout')?.value;
    if (timeout) {
      curl += ` \\\n  --max-time ${timeout}`;
    }

    const maxRedirects = this.container.querySelector('#opt-max-redirects')?.value;
    if (maxRedirects) {
      curl += ` \\\n  --max-redirs ${maxRedirects}`;
    }

    const userAgent = this.container.querySelector('#opt-user-agent')?.value;
    if (userAgent) {
      curl += ` \\\n  -A "${userAgent}"`;
    }

    // URL (last)
    curl += ` \\\n  "${url}"`;

    const output = this.container.querySelector('#curl-output');
    output.textContent = curl;
    this.context.setOutput(curl);
  },

  copyCurl() {
    const curl = this.context.getOutput();
    if (curl) {
      navigator.clipboard.writeText(curl).then(() => {
        const btn = this.container.querySelector('#copy-curl-btn');
        const original = btn.textContent;
        btn.textContent = '‚úì Copied!';
        setTimeout(() => btn.textContent = original, 2000);
      });
    }
  },

  exportCurl() {
    const curl = this.context.getOutput();
    const blob = new Blob([curl], { type: 'text/plain' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'request.sh';
    a.click();
    URL.revokeObjectURL(url);
  },

  onInput(input, context) {
    return { output: "" };
  }
};

// Standalone mode initialization
if (typeof window !== 'undefined' && !window.DevChef) {
  document.addEventListener('DOMContentLoaded', () => {
    const isStandalone = !document.querySelector('#workspace');

    if (isStandalone) {
      const standaloneContext = {
        input: "",
        output: "",
        setInput(val) { this.input = val; },
        setOutput(val) { this.output = val; },
        getInput() { return this.input; },
        getOutput() { return this.output; }
      };

      const template = document.querySelector('#tool-ui');
      if (template) {
        document.body.innerHTML = template.innerHTML;
        DevChefTool.init(document.body, standaloneContext);
      }
    }
  });
}
</script>

</body>
</html>
